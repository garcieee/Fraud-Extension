<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scraper Test Harness</title>
    <meta name="description" content="This is a test page for the fraud scraper.">
    <style>
        body {
            font-family: monospace;
            padding: 20px;
        }

        #output {
            background: #eee;
            padding: 10px;
            border: 1px solid #ccc;
            white-space: pre-wrap;
        }

        #message {
            font-size: 18px;
            font-weight: bold;
            color: #28a745;
            margin: 10px 0;
        }

        #url-input {
            width: 100%;
            max-width: 600px;
            padding: 8px;
            margin: 10px 0;
            font-size: 14px;
        }

        .hidden {
            display: none;
        }
    </style>
</head>

<body>
    <h1>Scraper Test Harness</h1>

    <!-- Test Elements -->
    <form action="http://phishing-site.com/login">
        <input type="text" name="username" placeholder="Username">
        <input type="password" name="password" placeholder="Password">
        <input type="text" name="cc_number" placeholder="Credit Card">
    </form>

    <div style="display:none">Hidden Content</div>
    <div style="position:fixed; width:100%; height:100%; z-index:9999; pointer-events:none;">Overlay (Simulated)</div>

    <p>Urgent! Verify your account immediately to claim your reward.</p>

    <div>
        <label for="url-input">URL to scrape (navigate to this page first):</label><br>
        <input type="url" id="url-input" placeholder="https://example.com"
            value="https://en.wikipedia.org/wiki/Main_Page">
        <button id="navigate-btn">Navigate to URL</button>
    </div>

    <button id="run-btn">Scrape Current Page</button>
    <div id="message"></div>
    <pre id="output"></pre>

    <script type="module">
        import { extractPageSignals, saveScrapeResults } from '../scraper/scraper.js';

        document.getElementById('run-btn').addEventListener('click', () => {
            const signals = extractPageSignals();
            const filename = saveScrapeResults(signals);
            document.getElementById('message').textContent = 'Website scraped';
            document.getElementById('output').textContent = `Saved to: ${filename}\n\n${JSON.stringify(signals, null, 2)}`;
            console.log('Scrape results:', signals);
        });

        document.getElementById('navigate-btn').addEventListener('click', () => {
            const url = document.getElementById('url-input').value.trim();
            if (url) {
                window.location.href = url;
            } else {
                alert('Please enter a URL');
            }
        });
    </script>
</body>

</html>